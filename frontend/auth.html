<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login & Sign Up</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Open Sans', Arial, sans-serif; }
    h1, h2 { font-family: 'Montserrat', Arial, sans-serif; }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-100 via-[#F3F4F6] to-[#E0E7FF] min-h-screen flex items-center justify-center">
  <div class="w-full max-w-md p-4">
    <!-- Tab Navigation -->
    <div class="flex mb-6 rounded-full overflow-hidden shadow">
      <button id="tab-login" class="flex-1 py-2 px-4 text-center font-bold focus:outline-none bg-[#7C3AED] text-white transition-all duration-200 border-b-4 border-[#F59E0B]" type="button">Login</button>
      <button id="tab-signup" class="flex-1 py-2 px-4 text-center font-bold focus:outline-none bg-gray-200 text-[#7C3AED] transition-all duration-200" type="button">Sign Up</button>
    </div>
    <!-- Card -->
    <div class="bg-white rounded-2xl shadow-2xl px-8 py-10">
      <!-- Login with Google Button -->
      <a href="../backend/google-login.php" class="w-full flex items-center justify-center gap-2 bg-white border border-gray-300 text-[#7C3AED] font-bold py-2 rounded-full shadow hover:bg-gray-100 transition mb-4">
        <img src="https://www.svgrepo.com/show/475656/google-color.svg" alt="Google" class="w-5 h-5">
        Login with Google
      </a>
      <!-- Login Form -->
      <div id="login-section">
        <h2 class="text-3xl font-extrabold text-center mb-2">Login</h2>
        <p class="text-center text-gray-500 mb-6">Welcome back! Please login to your account.</p>
        <form id="login-form" class="space-y-4">
          <div class="relative">
            <span class="absolute left-3 top-3 text-gray-400">
              <!-- Email Icon -->
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M2.5 6.5l7.5 5 7.5-5"/><rect x="2.5" y="6.5" width="15" height="7" rx="2"/></svg>
            </span>
            <input id="login-email" name="email" type="email" placeholder="Email" class="w-full border border-gray-300 pl-10 p-2 rounded-lg focus:ring-2 focus:ring-[#7C3AED] focus:border-[#7C3AED] transition" required>
          </div>
          <div class="relative">
            <span class="absolute left-3 top-3 text-gray-400">
              <!-- Lock Icon -->
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><rect x="5" y="9" width="10" height="7" rx="2"/><path d="M7 9V7a3 3 0 016 0v2"/></svg>
            </span>
            <input id="login-password" name="password" type="password" placeholder="Password" class="w-full border border-gray-300 pl-10 p-2 rounded-lg focus:ring-2 focus:ring-[#7C3AED] focus:border-[#7C3AED] transition" required>
          </div>
          <button type="submit" class="w-full bg-[#7C3AED] text-white py-2 rounded-full font-bold shadow hover:bg-[#5B21B6] transition-all duration-200">Login</button>
          <div class="text-right mt-2">
            <a href="../password-reset.php" class="text-[#7C3AED] underline font-semibold hover:text-[#5B21B6] transition">Forgot password?</a>
          </div>
          <div id="login-message" class="text-center mt-2"></div>
        </form>
      </div>
      <!-- Sign Up Form -->
      <div id="signup-section" class="hidden">
        <h2 class="text-3xl font-extrabold text-center mb-2">Sign Up</h2>
        <p class="text-center text-gray-500 mb-6">Create your account to get started.</p>
        <form id="register-form" class="space-y-4">
          <div class="relative">
            <span class="absolute left-3 top-3 text-gray-400">
              <!-- User Icon -->
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><circle cx="10" cy="7" r="4"/><path d="M2 17a8 8 0 0116 0"/></svg>
            </span>
            <input id="register-name" name="name" type="text" placeholder="Full Name" class="w-full border border-gray-300 pl-10 p-2 rounded-lg focus:ring-2 focus:ring-[#7C3AED] focus:border-[#7C3AED] transition" required>
          </div>
          <div class="relative">
            <span class="absolute left-3 top-3 text-gray-400">
              <!-- Email Icon -->
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M2.5 6.5l7.5 5 7.5-5"/><rect x="2.5" y="6.5" width="15" height="7" rx="2"/></svg>
            </span>
            <input id="register-email" name="email" type="email" placeholder="Email" class="w-full border border-gray-300 pl-10 p-2 rounded-lg focus:ring-2 focus:ring-[#7C3AED] focus:border-[#7C3AED] transition" required>
          </div>
          <div class="relative">
            <span class="absolute left-3 top-3 text-gray-400">
              <!-- Lock Icon -->
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><rect x="5" y="9" width="10" height="7" rx="2"/><path d="M7 9V7a3 3 0 016 0v2"/></svg>
            </span>
            <input id="register-password" name="password" type="password" placeholder="Password" class="w-full border border-gray-300 pl-10 p-2 rounded-lg focus:ring-2 focus:ring-[#7C3AED] focus:border-[#7C3AED] transition" required>
          </div>
          <select id="register-role" name="role" class="w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-[#7C3AED] focus:border-[#7C3AED] transition" required>
            <option value="admin">Admin</option>
            <option value="media_team">Media Team</option>
            <option value="ministry_leader">Ministry Leader</option>
            <option value="event_coordinator">Event Coordinator</option>
            <option value="discipleship_leader">Discipleship Leader</option>
            <option value="registered_member">Registered Member</option>
          </select>
          <button type="submit" class="w-full bg-[#7C3AED] text-white py-2 rounded-full font-bold shadow hover:bg-[#5B21B6] transition-all duration-200">Register</button>
          <div id="register-message" class="text-center mt-2"></div>
        </form>
      </div>
    </div>
  </div>
  <script>
    // Tab switching logic
    const tabLogin = document.getElementById('tab-login');
    const tabSignup = document.getElementById('tab-signup');
    const loginSection = document.getElementById('login-section');
    const signupSection = document.getElementById('signup-section');

    tabLogin.addEventListener('click', function() {
      tabLogin.classList.add('bg-[#7C3AED]', 'text-white', 'border-b-4', 'border-[#F59E0B]');
      tabLogin.classList.remove('bg-gray-200', 'text-[#7C3AED]');
      tabSignup.classList.add('bg-gray-200', 'text-[#7C3AED]');
      tabSignup.classList.remove('bg-[#7C3AED]', 'text-white', 'border-b-4', 'border-[#F59E0B]');
      loginSection.classList.remove('hidden');
      signupSection.classList.add('hidden');
    });
    tabSignup.addEventListener('click', function() {
      tabSignup.classList.add('bg-[#7C3AED]', 'text-white', 'border-b-4', 'border-[#F59E0B]');
      tabSignup.classList.remove('bg-gray-200', 'text-[#7C3AED]');
      tabLogin.classList.add('bg-gray-200', 'text-[#7C3AED]');
      tabLogin.classList.remove('bg-[#7C3AED]', 'text-white', 'border-b-4', 'border-[#F59E0B]');
      signupSection.classList.remove('hidden');
      loginSection.classList.add('hidden');
    });

    // Login form handler
    document.getElementById('login-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value;
      const msg = document.getElementById('login-message');
      if (!email || !password) {
        msg.textContent = 'All fields are required.';
        msg.className = 'text-red-600 text-center mt-2';
        return;
      }
      const formData = new URLSearchParams();
      formData.append('email', email);
      formData.append('password', password);
      fetch('../backend/login.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: formData.toString()
      })
      .then(res => res.json())
      .then(data => {
        if (data.success && data.redirect) {
          window.location.href = data.redirect;
        } else {
          msg.textContent = data.message || 'Login failed.';
          msg.className = 'text-red-600 text-center mt-2';
        }
      })
      .catch(err => {
        msg.textContent = 'Login failed.';
        msg.className = 'text-red-600 text-center mt-2';
      });
    });
    // Register form handler
    document.getElementById('register-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const name = document.getElementById('register-name').value.trim();
      const email = document.getElementById('register-email').value.trim();
      const password = document.getElementById('register-password').value;
      const role = document.getElementById('register-role').value;
      const msg = document.getElementById('register-message');
      if (!name || !email || !password || !role) {
        msg.textContent = 'All fields are required.';
        msg.className = 'text-red-600 text-center mt-2';
        return;
      }
      const data = { name, email, password, role };
      fetch('../backend/register.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(res => res.json())
      .then(res => {
        msg.textContent = res.message;
        msg.className = res.success ? 'text-green-600 text-center mt-2' : 'text-red-600 text-center mt-2';
        if (res.success) {
          document.getElementById('register-form').reset();
          setTimeout(() => {
            tabLogin.click(); // Switch to login tab after successful registration
          }, 1500);
        }
      })
      .catch(err => {
        msg.textContent = 'Registration failed.';
        msg.className = 'text-red-600 text-center mt-2';
      });
    });
  </script>
</body>
</html> 