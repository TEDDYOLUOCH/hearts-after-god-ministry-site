<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login | Discipleship Portal | Hearts After God Ministry</title>
  <meta name="description" content="Login to access your discipleship journey with Hearts After God Ministry. Join our global discipleship community.">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#7C3AED',
            secondary: '#FDBA17',
            accent: '#2046B3',
          },
        },
      },
    }
  </script>
  <style>
    /* Hero section styling */
    .hero-gradient {
      background: linear-gradient(135deg, #7C3AED 0%, #2046B3 50%, #FDBA17 100%);
    }
    .hero-pattern {
      background-image: url('data:image/svg+xml;utf8,<svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="30" cy="30" r="1" fill="white" fill-opacity="0.1"/><circle cx="15" cy="15" r="0.5" fill="white" fill-opacity="0.1"/><circle cx="45" cy="45" r="0.5" fill="white" fill-opacity="0.1"/></svg>');
    }
    /* Login form styling */
    .login-form {
      background: linear-gradient(135deg, rgba(124, 58, 237, 0.05) 0%, rgba(253, 186, 23, 0.05) 100%);
      border: 1px solid rgba(124, 58, 237, 0.1);
    }
    .register-form {
      background: linear-gradient(135deg, rgba(32, 70, 179, 0.05) 0%, rgba(253, 186, 23, 0.05) 100%);
      border: 1px solid rgba(32, 70, 179, 0.1);
    }
    /* Toggle button styling */
    .toggle-active {
      background: linear-gradient(135deg, #7C3AED 0%, #2046B3 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(124, 58, 237, 0.3);
    }
    .toggle-inactive {
      background: white;
      color: #6B7280;
      transition: all 0.3s ease;
    }
    .toggle-inactive:hover {
      color: #7C3AED;
      transform: translateY(-1px);
    }
    /* Form input styling */
    .form-input {
      transition: all 0.3s ease;
    }
    .form-input:focus {
      transform: translateY(-1px);
      box-shadow: 0 8px 25px rgba(124, 58, 237, 0.15);
    }
    /* Button animations */
    .submit-btn {
      transition: all 0.3s ease;
    }
    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(124, 58, 237, 0.3);
    }
    /* Scripture quote styling */
    .scripture-quote {
      background: linear-gradient(135deg, rgba(124, 58, 237, 0.1) 0%, rgba(253, 186, 23, 0.1) 100%);
      border-left: 4px solid #FDBA17;
    }
  </style>
</head>
<body class="min-h-screen hero-gradient hero-pattern flex items-center justify-center p-4 relative">
  <!-- Background overlay -->
  <div class="absolute inset-0 bg-black/20"></div>
  
  <div class="w-full max-w-md mx-auto relative z-10">
    <!-- Hero Section -->
    <div class="text-center mb-8">
      <div class="flex justify-center mb-6">
        <img src="assets/images/WhatsApp Image 2025-07-04 at 17.27.34_37ced412.jpg" alt="Hearts After God Ministry Logo" class="w-20 h-20 rounded-full shadow-2xl border-4 border-white/20" />
      </div>
      <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">
        Discipleship <span class="text-[#FDBA17]">Portal</span>
      </h1>
      <p class="text-xl text-white/90 mb-6">Join our global discipleship community</p>
      
      <!-- Scripture Quote -->
      <div class="scripture-quote p-4 rounded-2xl mb-6 max-w-sm mx-auto border border-white/20">
        <blockquote class="text-sm italic text-white/95 mb-1">
          "Go therefore and make disciples of all nations..."
        </blockquote>
        <cite class="text-[#FDBA17] font-semibold text-xs">â€” Matthew 28:19</cite>
      </div>
    </div>

    <!-- Login/Register Card -->
    <div class="bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl w-full p-8 relative">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold text-[#2046B3] mb-2" id="form-title">Sign In</h2>
        <p class="text-gray-600" id="form-subtitle">Access your discipleship journey</p>
      </div>
      
      <!-- Toggle Buttons -->
      <div class="flex bg-gray-100 rounded-2xl p-1 mb-8">
        <button id="login-toggle" class="flex-1 py-3 px-6 rounded-xl font-bold toggle-active transition-all duration-300">Sign In</button>
        <button id="register-toggle" class="flex-1 py-3 px-6 rounded-xl font-bold toggle-inactive transition-all duration-300">Register</button>
      </div>
      
      <!-- Login Form -->
      <form id="login-form" class="login-form space-y-6 p-6 rounded-2xl">
        <div>
          <label for="login-email" class="block text-sm font-semibold text-[#2046B3] mb-2">Email Address</label>
          <input type="email" id="login-email" name="email" placeholder="Enter your email" required class="form-input w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#7C3AED] focus:border-[#7C3AED]" />
        </div>
        <div>
          <label for="login-password" class="block text-sm font-semibold text-[#2046B3] mb-2">Password</label>
          <input type="password" id="login-password" name="password" placeholder="Enter your password" required class="form-input w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#7C3AED] focus:border-[#7C3AED]" />
        </div>
        <button type="submit" class="submit-btn w-full bg-gradient-to-r from-[#7C3AED] to-[#2046B3] text-white py-4 rounded-xl font-bold shadow-lg">
          <span class="flex items-center justify-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"/>
            </svg>
            Sign In
          </span>
        </button>
      </form>
      
      <!-- Register Form -->
      <form id="register-form" class="register-form space-y-6 p-6 rounded-2xl hidden">
        <div>
          <label for="register-name" class="block text-sm font-semibold text-[#2046B3] mb-2">Full Name</label>
          <input type="text" id="register-name" name="name" placeholder="Enter your full name" required class="form-input w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#2046B3] focus:border-[#2046B3]" />
        </div>
        <div>
          <label for="register-email" class="block text-sm font-semibold text-[#2046B3] mb-2">Email Address</label>
          <input type="email" id="register-email" name="email" placeholder="Enter your email" required class="form-input w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#2046B3] focus:border-[#2046B3]" />
        </div>
        <div>
          <label for="register-password" class="block text-sm font-semibold text-[#2046B3] mb-2">Password</label>
          <input type="password" id="register-password" name="password" placeholder="Create a password" required class="form-input w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#2046B3] focus:border-[#2046B3]" />
        </div>
        <div>
          <label for="register-confirm-password" class="block text-sm font-semibold text-[#2046B3] mb-2">Confirm Password</label>
          <input type="password" id="register-confirm-password" name="confirm-password" placeholder="Confirm your password" required class="form-input w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#2046B3] focus:border-[#2046B3]" />
        </div>
        <button type="submit" class="submit-btn w-full bg-gradient-to-r from-[#2046B3] to-[#7C3AED] text-white py-4 rounded-xl font-bold shadow-lg">
          <span class="flex items-center justify-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"/>
            </svg>
            Create Account
          </span>
        </button>
      </form>
      
      <!-- Message Display -->
      <div id="message" class="mt-6 text-center text-sm font-semibold"></div>
      
      <!-- Back to Portal Link -->
      <div class="mt-8 text-center">
        <a href="discipleship.html" class="inline-flex items-center gap-2 text-[#7C3AED] hover:text-[#2046B3] font-bold transition-all duration-300 transform hover:scale-105">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
          </svg>
          <span>Back to Discipleship Portal</span>
        </a>
      </div>
    </div>
    
    <!-- Footer -->
    <div class="text-center mt-8">
      <p class="text-white/90 text-sm font-medium">&copy; 2025 Hearts After God Ministry. All rights reserved.</p>
      <p class="text-white/70 text-xs mt-1">Empowering Believers. Winning Souls.</p>
    </div>
  </div>

  <script src="assets/js/discipleship-backend.js"></script>
  <script>
    // Initialize backend and ensure admin user exists
    document.addEventListener('DOMContentLoaded', function() {
      if (window.DiscipleshipBackend) {
        window.DiscipleshipBackend.ensureAdminUser();
        console.log('Backend initialized and admin user ensured');
      }
    });
    
    // Toggle between login and register forms
    const loginToggle = document.getElementById('login-toggle');
    const registerToggle = document.getElementById('register-toggle');
    const loginForm = document.getElementById('login-form');
    const registerForm = document.getElementById('register-form');
    const formTitle = document.getElementById('form-title');
    const formSubtitle = document.getElementById('form-subtitle');
    const messageDiv = document.getElementById('message');

    function showLogin() {
      loginForm.classList.remove('hidden');
      registerForm.classList.add('hidden');
      loginToggle.className = 'flex-1 py-3 px-6 rounded-xl font-bold toggle-active transition-all duration-300';
      registerToggle.className = 'flex-1 py-3 px-6 rounded-xl font-bold toggle-inactive transition-all duration-300';
      formTitle.textContent = 'Sign In';
      formSubtitle.textContent = 'Access your discipleship journey';
      messageDiv.textContent = '';
      messageDiv.className = 'mt-6 text-center text-sm font-semibold';
    }
    
    function showRegister() {
      loginForm.classList.add('hidden');
      registerForm.classList.remove('hidden');
      registerToggle.className = 'flex-1 py-3 px-6 rounded-xl font-bold toggle-active transition-all duration-300';
      loginToggle.className = 'flex-1 py-3 px-6 rounded-xl font-bold toggle-inactive transition-all duration-300';
      formTitle.textContent = 'Register';
      formSubtitle.textContent = 'Create your account to start your discipleship journey';
      messageDiv.textContent = '';
      messageDiv.className = 'mt-6 text-center text-sm font-semibold';
    }
    
    loginToggle.addEventListener('click', showLogin);
    registerToggle.addEventListener('click', showRegister);

    // Login form handler
    loginForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      
      console.log('Login attempt:', email);
      
      // Use the backend authentication
      if (window.DiscipleshipBackend) {
        const user = window.DiscipleshipBackend.authenticateUser(email, password);
        
        if (user) {
          console.log('Login successful:', user.name, 'Role:', user.role);
          
          // Store user session
          localStorage.setItem('discipleship_logged_in_user', JSON.stringify({
            id: user.id,
            name: user.name,
            email: user.email,
            role: user.role
          }));
          
          // Redirect based on role
          if (user.role === 'admin') {
            console.log('Redirecting to admin dashboard...');
            messageDiv.textContent = 'Login successful! Redirecting to admin dashboard...';
            messageDiv.className = 'mt-6 text-center text-sm font-semibold text-green-600';
            setTimeout(() => {
              window.location.href = 'discipleship-admin.html';
            }, 1000);
          } else {
            console.log('Redirecting to user dashboard...');
            messageDiv.textContent = 'Login successful! Redirecting to user dashboard...';
            messageDiv.className = 'mt-6 text-center text-sm font-semibold text-green-600';
            setTimeout(() => {
              window.location.href = 'discipleship-user.html';
            }, 1000);
          }
        } else {
          console.log('Login failed - invalid credentials');
          messageDiv.textContent = 'Invalid email or password. Please try again.';
          messageDiv.className = 'mt-6 text-center text-sm font-semibold text-red-600';
        }
      } else {
        console.log('Backend not available');
        messageDiv.textContent = 'System error. Please refresh the page and try again.';
        messageDiv.className = 'mt-6 text-center text-sm font-semibold text-red-600';
      }
    });
    
    // Registration form handler
    registerForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const name = document.getElementById('register-name').value;
      const email = document.getElementById('register-email').value;
      const password = document.getElementById('register-password').value;
      const confirm = document.getElementById('register-confirm-password').value;
      
      if (password !== confirm) {
        messageDiv.textContent = 'Passwords do not match.';
        messageDiv.className = 'mt-6 text-center text-sm font-semibold text-red-600';
        return;
      }
      
      if (password.length < 6) {
        messageDiv.textContent = 'Password must be at least 6 characters.';
        messageDiv.className = 'mt-6 text-center text-sm font-semibold text-red-600';
        return;
      }
      
      // Use the backend to create user
      if (window.DiscipleshipBackend) {
        try {
          const userData = {
            name: name,
            email: email,
            password: password
          };
          
          const newUser = window.DiscipleshipBackend.createUser(userData);
          
          if (newUser) {
            messageDiv.textContent = 'Account created successfully! You can now sign in.';
            messageDiv.className = 'mt-6 text-center text-sm font-semibold text-green-600';
            registerForm.reset();
            setTimeout(showLogin, 2000);
          } else {
            messageDiv.textContent = 'Error creating account. Please try again.';
            messageDiv.className = 'mt-6 text-center text-sm font-semibold text-red-600';
          }
        } catch (error) {
          messageDiv.textContent = 'Error creating account. Please try again.';
          messageDiv.className = 'mt-6 text-center text-sm font-semibold text-red-600';
        }
      } else {
        messageDiv.textContent = 'System error. Please refresh the page and try again.';
        messageDiv.className = 'mt-6 text-center text-sm font-semibold text-red-600';
      }
    });
  </script>
</body>
</html> 